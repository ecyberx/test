ホットキーテキスト太郎 Ver.1.40 使用方法
2008.12.15 fukatsu

================================================================================
○ 概要
	ホットキーテキスト太郎は、ホットキーを押すことで日付やバージョン情報などを
	入力させることができるツールです。
	例えば、CONTROL+ALT+";"キーを押すと日付"2007.05.06"を現在開いている
	エディタ(メモ帳でもOK)に挿入する、といったことができます。
	
	
	ホットキーテキスト太郎では、以下の機能を持ちます。
	
		・ホットキーの押下により指定した任意のテキストを入力する
		・ホットキーの押下によりクリップボードにコピーしたテキストの内容を
		  ファイルに保存する。(保存したファイルをエディタ/エクスプローラで開く)
		・ホットキーの押下により任意のアプリケーションを起動する

	
	ホットキーによるテキストの入力については、
	Word2003、Excel2003、サクラエディタ、Visual C++.NET 2003での動作を確認しました。
	Thunderbirdでは一部の組み合わせ(Ctrlキーなど)で正常動作しないようです。
	("Ctrl+2"などでデフォルトのショートカットキーが動作してしまうのが原因)
	
	
	※ 主に自分用、趣味全開の作りになっています。使いにくい場合は添付のソースを
	   いじって使いやすくするか、他のツールを使ってください。
	   不明点や要望があれば、私までメールその他でご連絡ください。
	
================================================================================
○ 動作環境
	ホットキーテキスト太郎は、32ビットのWindowsXP,2000で動作します。
	9x系およびVistaへの対応状況は未確認です。
	また、64ビット系OSでの動作も未確認です。
	
================================================================================
○ インストール方法
	ファイルhottext.exeおよびhottext.cfgを、適当なフォルダへコピーしてください。
	(これらの二つのファイルは必ず同じフォルダに格納してください)
	
	アンインストールは、これらのファイルを削除することで完了します。
	レジストリは使用していません。

================================================================================
○ 使用方法
	■ とりあえず使ってみる
		ホットキーテキスト太郎は、デフォルトで日付と時刻を挿入する設定が
		定義されています。
		以下の手順で、日付をエディタへ挿入できます。
		
		1) hottext.exeをダブルクリックなどで起動する
			→ タスクトレイへアイコンが追加されます。
		2) エディタを開いて、CONTROLキー＋ALTキーを押しながら
		　 ';'(セミコロン)キーを押下する
		　 	→ 現在の日付("2007.05.06"など)がエディタへ挿入されます。
		
		※ ダウンロード直後の定義ファイルで定義している内容は以下の通りです。
		
			Ctrl+Alt+セミコロン		日付(yyyy.mm.dd)
			Ctrl+Alt+コロン			時刻(hh:mm:ss)
			Ctrl+Alt+'1'			改定コメント(/* changed by %USERNAME% %$yyyy.mm.dd hh:mm:ss% */)
			Shift+Alt+'P'			環境変数PATH(%PATH%)
			Windows+'C'				現在のクリップボードの内容をファイル"%TEMP%\cliptext_%yyyymmddhhmmss.txt"に保存し
									ファイルをエディタで開く。
			Ctrl+Alt+'C'			現在のクリップボードの内容をファイル"%TEMP%\cliptext_%yyyymmddhhmmss.txt"に保存し
									ファイルをエクスプローラで開く。
			Ctrl+Alt+'E'			エクスプローラを現在クリップボードにコピーしているテキストのファイルを指定して開く
			Ctrl+Shift+'C'			現在クリップボードにコピーしているテキストのフォルダを指定してコマンドプロンプトを開く
	
	■ 起動方法
		hottext.exeを実行することで起動します。
	
	■ 終了方法
		タスクトレイ上のアイコンを右クリックし、
		ポップアップメニューの"QUIT"を選択することで終了します。
		また、"ABOUT"で表示されるダイアログの"終了"ボタンまたは
		×ボタンの押下でも終了させることができます。

================================================================================
○ 設定ファイルの変更方法
	ホットキーおよびキーが押された場合に挿入される文字列は
	設定ファイルhottext.cfgにて記述されています。
	hottext.cfgは、C/C++プリプロセッサとほぼ同様の記述に対応しています。
	(マクロやヘッダファイルのインクルードなどが可能。)
	hottext.cfgの変更を有効にするには、ホットキーテキスト太郎の再起動、
	またはタスクトレイのアイコン右クリック→"設定ファイルを再読込"を
	選択する必要があります。
	
	※ 設定内容などの詳細はhottext.cfg内のコメントを参照ください。
	
	・キー定義の追加方法
	  □ テキスト入力
		key "app/action_input"{ ... }内に、以下の記述を追加してください。
		
			key "app/action_input"
			{
				key=[キーコード];
				mod=[同時押し];
				format=[挿入テキスト];
			};
		
		key(キーコード)
			ホットキーのキーコードを記述してください。
			キーコードは、Windowsの仮想キーコード(VK_???)に
			対応する数値または文字を指定してください。
			
			ex)
				'A'キーを指定する場合は以下のいずれかの記述
					key='A';
					key="A";
					key=0x41;
					key=65:
			
			※ 仮想キーコードは、以下のようなツールで取得可能です
			
				Bakeneko Kelly
				http://www.vector.co.jp/soft/win95/util/se143682.html
				
				また、インターネットで"仮想キーコード"で検索すれば
				いくつか資料が見つかります。
				
				
		mod(同時押し)
			key(キーコード)で指定したキーと同時に押すキーを指定します。
			SHIFT,ALT,CONTROLキーの一つ以上のキーの組み合わせを指定
			します。
			
			ex)
				SHIFTキー+'A'キーの場合
					key='A';
					mod=MOD_SHIFT;
			ex)
				ALTキー+CONTROLキー+テンキーの'1'の場合
					key=97;
					mod=MOD_ALT|MOD_CONTROL;
		
		format(挿入テキスト)
			上記の条件のキーが押された場合に挿入されるテキストを
			記述します。
			テキストは、通常の文字列の他に、日付・環境変数を含むことが
			できます。
			
			環境変数
				%〜%で囲まれた範囲に変数名を記述してください。
				ex)
					%path%		→ "C:\Program Files\..."
					
			日付
				%$〜%で囲まれた範囲に日付・時刻の出力形式を記述して
				ください。
				※ 基本的にExcelとほぼ同じフォーマットです。
				
				ex)
					%$yyyy.mm.dd%	→ 2007.05.06
			改行
				"\n"で改行させることができます。
			
			クリップボード
				テキスト中に%!clipboard%と記入することで、
				現在クリップボードにコピーされているテキストを
				文字列中に展開することができます。
				クリップボードにテキストがコピーされていない場合は
				%!clipboard%は無視されます。
			
			
	  □ クリップボードのテキスト保存
		key "app/action_cliptext"{ ... }内に、以下の記述を追加してください。
		
			key "app/action_cliptext"
			{
				key=[キーコード];
				mod=[同時押し];
				path=[保存するファイル名];
			};
			
			キーコード・同時押しの設定は上記のテキスト入力のものと同様の設定です。
			保存するファイル名には、ファイル名のフルパスを設定してください。
			設定の文字列は環境変数や日付を含むことができます。
			
				ex)
					path="%TEMP%/cliptext/cliptext_%$yyyymmddhhmmss%.txt";
					→ C:\Document and Settings\...\cliptext_20081207013103.txtに
					　 保存される。

	  □ 任意のアプリケーション実行
		key "app/action_shell"{ ... }内に、以下の記述を追加してください。
		
			key "app/action_shell"
			{
				key=[キーコード];
				mod=[同時押し];
				app=[実行するアプリケーションのexeファイル];
				path=[アプリケーションを起動するパス];
				opt=[アプリケーションの起動オプション];
			};
			
			キーコード・同時押しの設定は上記のテキスト入力のものと同様の設定です。
			実行するアプリケーションのexeファイルには、"explorer.exe"や"cmd.exe"など
			実行ファイル名を指定してください。
			環境変数PATHで指定されていないパスにある実行ファイルについては、
			フルパスを指定してください。(app="c:/program files/sakura/sakura.exe";など)
			


================================================================================
○ 自動で開くように設定したファイルがメモ帳で開かれてしまう場合
	
	このツールでは、テキストファイルを開く場合、".txt"拡張子の"open"に
	割り当てられたアプリケーションでファイルを開きます。
	サクラエディタなど、拡張子の関連づけを変更しても"open"はメモ帳のまま、
	というツールを使用している場合は、手動で".txt"の"open"を変更する
	必要があります。


================================================================================
◇ 今後の拡張予定＆memo
・テキストの挿入にこだわらず、ホットキーで色々できるようにしたい
	→ マウス関連の操作やメニューの選択、キーボードマクロなど
	→ iTunesの曲送りなんかができるとうれしい。
(2008.12.07)
・プラグイン方式を採用。それからインタフェースをちょこちょこ更新。
　クリップボードのファイル保存は実験的だけど使い勝手がありそう？
　そろそろ次郎にしたい。
(2008.12.15)
・クリップボードのファイル保存後、エクスプローラでファイルを開く機能を追加。
　エディタで開いている文字列の一部分を比較したいときに、わざわざ手動で
　ファイル保存しなくてもWinMergeやDF.exeなどで簡単に比較できるようにしたかったので。
・任意アプリの起動は、簡単に実装できそうだったので試しに追加してみた機能。
　perlのスクリプトなどをキーひとつで実行できるようになる、はず。


以上
